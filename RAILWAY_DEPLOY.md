# –î–µ–ø–ª–æ–π –±—ç–∫–µ–Ω–¥–∞ –Ω–∞ Railway

## –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç–≤–æ–π –∫–æ–¥ –∑–∞–ø—É—à–µ–Ω –≤ GitHub:
```bash
cd /Users/patientmbaya/Desktop/AdaptEd-Russia/adapted-russia
git add .
git commit -m "Prepare for Railway deployment"
git push
```

## –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Railway

1. –ó–∞–π–¥–∏ –Ω–∞ https://railway.app
2. –ù–∞–∂–º–∏ **"New Project"**
3. –í—ã–±–µ—Ä–∏ **"Deploy from GitHub repo"**
4. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Å—è —á–µ—Ä–µ–∑ GitHub (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
5. –í—ã–±–µ—Ä–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `adaptEd-Russia` (–∏–ª–∏ –∫–∞–∫ –æ–Ω –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —É —Ç–µ–±—è)
6. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –ø—Ä–æ–µ–∫—Ç

## –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–∏—Å–∞

1. Railway –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤. –ù–∞–π–¥–∏ —Å–µ—Ä–≤–∏—Å —Å –ø–∞–ø–∫–æ–π `server`
2. –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –Ω–µ —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - –ù–∞–∂–º–∏ **"New"** ‚Üí **"GitHub Repo"**
   - –í—ã–±–µ—Ä–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —É–∫–∞–∂–∏:
     - **Root Directory**: `server`
     - **Build Command**: `npm install && npm run build && npx prisma generate`
     - **Start Command**: `npm start`

## –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–π–¥–∏ –≤ **Variables** –∏ –¥–æ–±–∞–≤—å:

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
# Database (Railway —Å–æ–∑–¥–∞—Å—Ç PostgreSQL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
DATABASE_URL=<Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç, –∏—Å–ø–æ–ª—å–∑—É–π –∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é>

# JWT Secret (—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –Ω–æ–≤—É—é –¥–ª—è production)
JWT_SECRET=<—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))">

# Port (Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç)
PORT=3003

# Environment
NODE_ENV=production

# Client URL (—Ç–≤–æ–π Netlify —Å–∞–π—Ç)
CLIENT_URL=https://adaptedrussia.netlify.app

# YooKassa (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π)
YOOKASSA_SHOP_ID=—Ç–≤–æ–π-shop-id
YOOKASSA_SECRET_KEY=—Ç–≤–æ–π-secret-key
```

### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å DATABASE_URL –Ω–∞ Railway:

1. –í –ø—Ä–æ–µ–∫—Ç–µ Railway –Ω–∞–∂–º–∏ **"New"** ‚Üí **"Database"** ‚Üí **"PostgreSQL"**
2. Railway —Å–æ–∑–¥–∞—Å—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞–π–¥–∏ **"Connect"** ‚Üí **"Postgres Connection URL"**
4. –°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç URL –∏ –∏—Å–ø–æ–ª—å–∑—É–π –∫–∞–∫ `DATABASE_URL`

## –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

1. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç –¥–µ–ø–ª–æ–π
2. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è, –≤ **Settings** ‚Üí **Deploy** –Ω–∞–π–¥–∏ **"Run Command"**
3. –í—ã–ø–æ–ª–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:
   ```bash
   npx prisma migrate deploy
   ```
   –ò–ª–∏ —á–µ—Ä–µ–∑ Railway CLI:
   ```bash
   railway run npx prisma migrate deploy
   ```

## –®–∞–≥ 6: –ü–æ–ª—É—á–µ–Ω–∏–µ URL –±—ç–∫–µ–Ω–¥–∞

1. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è Railway –¥–∞—Å—Ç —Ç–µ–±–µ URL
2. –û–±—ã—á–Ω–æ —ç—Ç–æ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ: `https://adapted-russia-production.up.railway.app`
3. –°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç URL

## –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Netlify

1. –ó–∞–π–¥–∏ –≤ Netlify: https://app.netlify.com
2. –í—ã–±–µ—Ä–∏ —Å–∞–π—Ç `adaptedrussia`
3. –ü–µ—Ä–µ–π–¥–∏ –≤ **Site settings** ‚Üí **Environment variables**
4. –î–æ–±–∞–≤—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
   - **Key**: `NEXT_PUBLIC_API_URL`
   - **Value**: `https://—Ç–≤–æ–π-railway-url.up.railway.app/api`
5. –°–æ—Ö—Ä–∞–Ω–∏
6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –¥–µ–ø–ª–æ–π: **Deploys** ‚Üí **Trigger deploy** ‚Üí **Deploy site**

## –®–∞–≥ 8: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ CORS –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Netlify URL –≤ CORS. –û–±–Ω–æ–≤–∏ `server/src/index.ts`:

```typescript
app.use(cors({
  origin: [
    'http://localhost:3000',
    'https://adaptedrussia.netlify.app', // –î–æ–±–∞–≤—å —ç—Ç–æ
    ...(process.env.CLIENT_URL ? [process.env.CLIENT_URL] : [])
  ],
  credentials: true,
  // ...
}));
```

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—Ç—å –∏ –∑–∞–ø—É—à—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.

## –®–∞–≥ 9: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π —Å–∞–π—Ç –Ω–∞ Netlify
2. –ü–æ–ø—Ä–æ–±—É–π –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è/–≤–æ–π—Ç–∏
3. –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –æ—à–∏–±–∫–∏
4. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Railway –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Railway CLI

–£—Å—Ç–∞–Ω–æ–≤–∏ Railway CLI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
npm i -g @railway/cli
railway login
```

–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
railway status          # –°—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è
railway logs            # –õ–æ–≥–∏
railway variables       # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
railway shell           # SSH –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ `DATABASE_URL` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –∏ –∑–∞–ø—É—â–µ–Ω–∞

### CORS –æ—à–∏–±–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ `CLIENT_URL` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤ Railway
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ Netlify URL –¥–æ–±–∞–≤–ª–µ–Ω –≤ CORS

### –ü–æ—Ä—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ—Ä—Ç —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PORT`
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `process.env.PORT`

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- –í—ã–ø–æ–ª–Ω–∏ –≤—Ä—É—á–Ω—É—é: `railway run npx prisma migrate deploy`
- –ò–ª–∏ —á–µ—Ä–µ–∑ Railway Dashboard ‚Üí Deploy ‚Üí Run Command

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:
1. ‚úÖ –ë—ç–∫–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Railway
2. ‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ –±—ç–∫–µ–Ω–¥—É —á–µ—Ä–µ–∑ Netlify
3. ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å
4. ‚úÖ –í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å

–£–¥–∞—á–∏! üöÄ

